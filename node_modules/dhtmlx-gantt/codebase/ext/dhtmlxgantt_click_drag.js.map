{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/./sources/utils/helpers.js","webpack://[name]/./sources/ext/click_drag/selectedRegion.ts","webpack://[name]/./sources/ext/click_drag/eventsManager.ts","webpack://[name]/./sources/ext/click_drag/index.ts","webpack://[name]/./sources/utils/eventable.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","units","second","minute","hour","day","week","month","quarter","year","isDate","obj","getFullYear","getMonth","getDate","arrayFilter","arr","callback","result","filter","length","getSecondsInUnit","unit","forEach","workArray","slice","arrayMap","map","resArray","push","arrayFind","find","arrayDifference","item","arraySome","hashToArray","hash","sortArrayOfHash","field","desc","compare","a","b","sort","throttle","timeout","wait","apply","arguments","setTimeout","isArray","Array","undefined","pop","isValidDate","isNaN","getTime","isStringObject","Function","toString","constructor","isNumberObject","isBooleanObject","delay","timer","$cancelTimeout","$pending","args","this","clearTimeout","$execute","objectKeys","keys","requestAnimationFrame","w","webkitRequestAnimationFrame","msRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","cb","isEventable","attachEvent","detachEvent","eventable","helpers_1","_countSize","start","end","SelectedRegion","config","_this","_el","document","createElement","_viewPort","viewPort","classList","add","className","_callback","render","_startPoint","_endPoint","draw","_singleRow","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","setStyles","height","gantt","row_height","style","top","Math","ceil","_positionPoint","relative","width","left","appendChild","getElement","clear","parentNode","removeChild","getViewPort","setStart","startPoint","_startDate","dateFromPos","callEvent","setEnd","endPoint","_endDate","absolute","setPosition","positionPoint","dragEnd","valueOf","_a","tasksByTime","getTaskByTime","tasksByIndex","_getTasksByTop","getInBounds","startValue","endValue","startIndex","endIndex","getTaskByIndex","EventsManager","_mouseDown","_domEvents","_createDomEventScope","attach","selectedRegion","useKey","_target","_originPosition","getComputedStyle","display","_restoreOriginPosition","position","state","$services","getService","registerProvider","autoscroll","scheduledDndCoordinates","event","utils","dom","closest","target","_getCoordinates","body","coordinates","abs","detach","detachAll","unregisterProvider","destructor","viewPortBounds","getBoundingClientRect","clientX","clientY","scrollLeft","scrollTop","eventsManager_1","selectedRegion_1","ext","defaultConfig","eventsManager","clickDrag","__assign","$task_data","click_drag","EventHost","_connected","_silent_mode","_silentStart","_silentEnd","createEventStorage","dhx_catch","z","res","zr","addEvent","ev","removeEvent","id","eventHost","catcher","callObj","toLowerCase","attachAll","arg0","handlerName","concat","checkEvent","list","split","eventName","eventId","detachAllEvents","indexOf"],"mappings":"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","file":"ext/dhtmlxgantt_click_drag.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ext/dhtmlxgantt_click_drag\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ext/dhtmlxgantt_click_drag\"] = factory();\n\telse\n\t\troot[\"ext/dhtmlxgantt_click_drag\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/codebase/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 219);\n","var units = {\r\n\t\"second\": 1,\r\n\t\"minute\": 60,\r\n\t\"hour\": 60 * 60,\r\n\t\"day\": 60 * 60 * 24,\r\n\t\"week\": 60 * 60 * 24 * 7,\r\n\t\"month\": 60 * 60 * 24 * 30,\r\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\r\n\t\"year\": 60 * 60 * 24 * 365\r\n};\r\nfunction getSecondsInUnit(unit){\r\n\treturn units[unit] || units.hour;\r\n}\r\n\r\nfunction forEach(arr, callback) {\r\n\tif (arr.forEach) {\r\n\t\tarr.forEach(callback);\r\n\t} else {\r\n\t\tvar workArray = arr.slice();\r\n\t\tfor (var i = 0; i < workArray.length; i++) {\r\n\t\t\tcallback(workArray[i], i);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction arrayMap(arr, callback) {\r\n\tif (arr.map) {\r\n\t\treturn arr.map(callback);\r\n\t} else {\r\n\t\tvar workArray = arr.slice();\r\n\t\tvar resArray = [];\r\n\r\n\t\tfor (var i = 0; i < workArray.length; i++) {\r\n\t\t\tresArray.push(callback(workArray[i], i));\r\n\t\t}\r\n\t\treturn resArray;\r\n\t}\r\n}\r\n\r\n\r\nfunction arrayFind(arr, callback) {\r\n\tif (arr.find) {\r\n\t\treturn arr.find(callback);\r\n\t} else {\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tif (callback(arr[i], i)) {\r\n\t\t\t\treturn arr[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// iframe-safe array type check instead of using instanceof\r\nfunction isArray(obj){\r\n\tif(Array.isArray){\r\n\t\treturn Array.isArray(obj);\r\n\t}else{\r\n\t\t// close enough\r\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\r\n\t}\r\n}\r\n\r\n// non-primitive string object, e.g. new String(\"abc\")\r\nfunction isStringObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\r\n}\r\n\r\n// non-primitive number object, e.g. new Number(5)\r\nfunction isNumberObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\r\n}\r\n\r\n// non-primitive number object, e.g. new Boolean(true)\r\nfunction isBooleanObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\r\n}\r\n\r\nfunction isDate(obj) {\r\n\tif (obj && typeof obj === \"object\") {\r\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\r\n\t} else {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction isValidDate(obj){\r\n\treturn isDate(obj) && !isNaN(obj.getTime());\r\n}\r\n\r\nfunction arrayFilter(arr, callback) {\r\n\tvar result = [];\r\n\r\n\tif (arr.filter) {\r\n\t\treturn arr.filter(callback);\r\n\t} else {\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tif (callback(arr[i], i)) {\r\n\t\t\t\tresult[result.length] = arr[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nfunction hashToArray(hash) {\r\n\tvar result = [];\r\n\r\n\tfor (var key in hash) {\r\n\t\tif (hash.hasOwnProperty(key)) {\r\n\t\t\tresult.push(hash[key]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction arraySome(arr, callback) {\r\n\tif (arr.length === 0) return false;\r\n\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tif (callback(arr[i], i, arr)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction arrayDifference(arr, callback) {\r\n\treturn arrayFilter(arr, function(item, i) {\r\n\t\treturn !callback(item, i);\r\n\t});\r\n}\r\n\r\nfunction throttle (callback, timeout) {\r\n\tvar wait = false;\r\n\r\n\treturn function () {\r\n\t\tif (!wait) {\r\n\t\t\tcallback.apply(null, arguments);\r\n\t\t\twait = true;\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\twait = false;\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction delay (callback, timeout){\r\n\tvar timer;\r\n\r\n\tvar result = function() {\r\n\t\tresult.$cancelTimeout();\r\n\t\tcallback.$pending = true;\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\ttimer = setTimeout(function(){\r\n\t\t\tcallback.apply(this, args);\r\n\t\t\tresult.$pending = false;\r\n\t\t}, timeout);\r\n\t};\r\n\t\r\n\tresult.$pending = false;\r\n\tresult.$cancelTimeout = function(){\r\n\t\tclearTimeout(timer);\r\n\t\tcallback.$pending = false;\r\n\t};\r\n\tresult.$execute = function(){\r\n\t\tcallback();\r\n\t\tcallback.$cancelTimeout();\r\n\t};\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction sortArrayOfHash(arr, field, desc) {\r\n\tvar compare = function(a, b) {\r\n\t\treturn a < b;\r\n\t};\r\n\r\n\tarr.sort(function(a, b) {\r\n\t\tif (a[field] === b[field]) return 0;\r\n\r\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\r\n\t});\r\n}\r\n\r\nfunction objectKeys(obj) {\r\n\tif (Object.keys) {\r\n\t\treturn Object.keys(obj);\r\n\t}\r\n\tvar result = [];\r\n\tvar key;\r\n\tfor (key in obj) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n\t\t\tresult.push(key);\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction requestAnimationFrame(callback) {\r\n\tvar w = window;\r\n\tvar foundRequestAnimationFrame = w.requestAnimationFrame\r\n\t\t|| w.webkitRequestAnimationFrame\r\n\t\t|| w.msRequestAnimationFrame\r\n\t\t|| w.mozRequestAnimationFrame\r\n\t\t|| w.oRequestAnimationFrame\r\n\t\t|| function(cb) { setTimeout(cb, 1000/60); };\r\n\treturn foundRequestAnimationFrame(callback);\r\n}\r\n\r\nfunction isEventable(obj) {\r\n\treturn obj.attachEvent && obj.detachEvent;\r\n}\r\n\r\nmodule.exports = {\r\n\tgetSecondsInUnit: getSecondsInUnit,\r\n\tforEach: forEach,\r\n\tarrayMap: arrayMap,\r\n\tarrayFind: arrayFind,\r\n\tarrayFilter: arrayFilter,\r\n\tarrayDifference: arrayDifference,\r\n\tarraySome: arraySome,\r\n\thashToArray: hashToArray,\r\n\tsortArrayOfHash: sortArrayOfHash,\r\n\tthrottle: throttle,\r\n\tisArray: isArray,\r\n\tisDate: isDate,\r\n\tisValidDate: isValidDate,\r\n\tisStringObject: isStringObject,\r\n\tisNumberObject: isNumberObject,\r\n\tisBooleanObject: isBooleanObject,\r\n\tdelay: delay,\r\n\tobjectKeys: objectKeys,\r\n\trequestAnimationFrame: requestAnimationFrame,\r\n\tisEventable: isEventable\r\n};","import * as eventable from \"../../utils/eventable\";\r\nimport { isEventable, requestAnimationFrame } from \"../../utils/helpers\";\r\ndeclare const gantt;\r\n\r\nexport interface ISelectedRegionConfig {\r\n\tclassName?: string;\r\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\r\n\tviewPort?: HTMLElement;\r\n\tuseRequestAnimationFrame: boolean;\r\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\r\n\tsingleRow: boolean;\r\n}\r\n\r\ninterface ICoordinates {\r\n\tleft: number;\r\n\ttop: number;\r\n}\r\n\r\nexport interface IPoint {\r\n\tabsolute: ICoordinates;\r\n\trelative: ICoordinates;\r\n}\r\n\r\n\r\nfunction _countSize(start: number, end: number) {\r\n\tconst result = start - end;\r\n\tif (result >= 0) {\r\n\t\treturn result;\r\n\t}\r\n\treturn -result;\r\n}\r\n\r\nexport class SelectedRegion {\r\n\tprivate _viewPort: HTMLElement & eventable;\r\n\tprivate _el: HTMLElement = document.createElement(\"div\");\r\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\r\n\tprivate _startPoint: IPoint;\r\n\tprivate _endPoint: IPoint;\r\n\tprivate _positionPoint: IPoint;\r\n\tprivate _useRequestAnimationFrame: boolean;\r\n\tprivate _startDate: Date;\r\n\tprivate _endDate: Date;\r\n\tprivate _singleRow: boolean;\r\n\tconstructor(config: ISelectedRegionConfig) {\r\n\t\tthis._viewPort = config.viewPort;\r\n\t\tthis._el.classList.add(config.className);\r\n\t\tif (typeof config.callback === \"function\") {\r\n\t\t\tthis._callback = config.callback;\r\n\t\t}\r\n\t\tif (typeof config.render === \"function\") {\r\n\t\t\tthis.render = () => {\r\n\t\t\t\tthis._el = config.render(this._startPoint, this._endPoint);\r\n\t\t\t\tif (config.className !== \"\") {\r\n\t\t\t\t\tthis._el.classList.add(config.className);\r\n\t\t\t\t}\r\n\t\t\t\tthis.draw();\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (!isEventable(this._viewPort)) {\r\n\t\t\teventable(this._viewPort);\r\n\t\t}\r\n\t\tthis._singleRow = config.singleRow;\r\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\r\n\t}\r\n\r\n\tsetStyles() {\r\n\t\tif (this._singleRow) {\r\n\t\t\tconst height = gantt.config.row_height;\r\n\t\t\tthis._el.style.height = height + \"px\";\r\n\t\t\tthis._el.style.top = (Math.ceil(this._positionPoint.relative.top / height) - 1) * height + \"px\";\r\n\t\t} else {\r\n\t\t\tthis._el.style.height = _countSize(this._endPoint.relative.top, this._startPoint.relative.top) + \"px\";\r\n\t\t\tthis._el.style.top = this._positionPoint.relative.top + \"px\";\r\n\t\t}\r\n\t\tthis._el.style.width = _countSize(this._endPoint.relative.left, this._startPoint.relative.left) + \"px\";\r\n\t\tthis._el.style.left = this._positionPoint.relative.left + \"px\";\r\n\t}\r\n\r\n\trender() {\r\n\t\tthis.setStyles();\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tif (this._useRequestAnimationFrame) {\r\n\t\t\treturn requestAnimationFrame(() => {\r\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis._viewPort.appendChild(this.getElement());\r\n\t\t}\r\n\t}\r\n\r\n\tclear() {\r\n\t\tif (this._useRequestAnimationFrame) {\r\n\t\t\treturn requestAnimationFrame(() => {\r\n\t\t\t\tif (!this._el.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis._viewPort.removeChild(this._el);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (!this._el.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._viewPort.removeChild(this._el);\r\n\t\t}\r\n\t}\r\n\r\n\tgetElement() {\r\n\t\treturn this._el;\r\n\t}\r\n\r\n\tgetViewPort() {\r\n\t\treturn this._viewPort;\r\n\t}\r\n\r\n\tsetStart(startPoint: IPoint) {\r\n\t\tthis._startPoint = startPoint;\r\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\r\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\r\n\t}\r\n\r\n\tsetEnd(endPoint: IPoint) {\r\n\t\tthis._endPoint = endPoint;\r\n\t\tif (this._singleRow) {\r\n\t\t\tconst height = gantt.config.row_height;\r\n\t\t\tthis._endPoint.relative.top = (Math.ceil(this._startPoint.relative.top / height)) * height;\r\n\t\t}\r\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\r\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\r\n\t\t\tthis._positionPoint = {\r\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\r\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\r\n\t\t\tthis._positionPoint = {\r\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\r\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\r\n\t\t\t};\r\n\t\t}\r\n\r\n\r\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\r\n\t}\r\n\r\n\tsetPosition(positionPoint: IPoint) {\r\n\t\tthis._positionPoint = positionPoint;\r\n\t}\r\n\r\n\tdragEnd(endPoint: IPoint) {\r\n\t\tif(endPoint.relative.left < 0){\r\n\t\t\tendPoint.relative.left = 0;\r\n\t\t}\r\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\r\n\t\tthis.setEnd(endPoint);\r\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\r\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\r\n\t\t}\r\n\t\tthis.clear();\r\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\r\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\r\n\r\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\r\n\t\tif (this._callback) {\r\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\r\n\t\t}\r\n\t}\r\n\r\n\tgetInBounds() {\r\n\t\treturn this._singleRow;\r\n\t}\r\n\r\n\tprivate _getTasksByTop(start: number, end:number) {\r\n\t\tlet startValue = start;\r\n\t\tlet endValue = end;\r\n\t\tif (start > end) {\r\n\t\t\tstartValue = end;\r\n\t\t\tendValue = start;\r\n\t\t}\r\n\t\tconst height = gantt.config.row_height;\r\n\t\tconst startIndex = Math.ceil(startValue / height) - 1;\r\n\t\tconst endIndex = Math.ceil(endValue / height) - 1;\r\n\t\tconst result = [];\r\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\r\n\t\t\tconst task = gantt.getTaskByIndex(i);\r\n\t\t\tif (task) {\r\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}","import { SelectedRegion } from \"./selectedRegion\";\r\n\r\ndeclare const gantt;\r\nexport class EventsManager {\r\n\tprivate _mouseDown: boolean = false;\r\n\tprivate _domEvents: any;\r\n\tprivate _originPosition: string;\r\n\tprivate _restoreOriginPosition: () => void;\r\n\tconstructor() {\r\n\t\tthis._domEvents = gantt._createDomEventScope();\r\n\t}\r\n\r\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\"): void {\r\n\t\tconst _target = selectedRegion.getViewPort();\r\n\t\tthis._originPosition = window.getComputedStyle(_target).display;\r\n\t\tthis._restoreOriginPosition = () => {\r\n\t\t\t_target.style.position = this._originPosition;\r\n\t\t};\r\n\t\tif (this._originPosition === \"static\") {\r\n\t\t\t_target.style.position = \"relative\";\r\n\t\t}\r\n\t\tconst state = gantt.$services.getService(\"state\");\r\n\t\tstate.registerProvider(\"clickDrag\", () => {\r\n\t\t\tconst result = { autoscroll: false };\r\n\t\t\treturn result;\r\n\t\t});\r\n\r\n\r\n\t\tlet scheduledDndCoordinates = null;\r\n\t\tconst startDragAndDrop = () => {\r\n\t\t\tif (!scheduledDndCoordinates) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tselectedRegion.setStart(scheduledDndCoordinates);\r\n\t\t\tselectedRegion.setPosition(scheduledDndCoordinates);\r\n\t\t\tselectedRegion.setEnd(scheduledDndCoordinates);\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t};\r\n\r\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t\tif (gantt.utils.dom.closest(event.target, \".gantt_task_line, .gantt_task_link\")) { return; }\r\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\r\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\r\n\t\t\t\treturn result;\r\n\t\t\t});\r\n\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t});\r\n\r\n\t\tthis._domEvents.attach(document.body, \"mouseup\", (event) => {\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\tif (this._mouseDown === true) {\r\n\t\t\t\tthis._mouseDown = false;\r\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tselectedRegion.dragEnd(coordinates);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\tlet coordinates = null;\r\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\r\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\r\n\t\t\t\t\t// add small threshold not to start dnd on simple click\r\n\t\t\t\t\tstartDragAndDrop();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this._mouseDown === true) {\r\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tselectedRegion.setEnd(coordinates);\r\n\t\t\t\tselectedRegion.render();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdetach(): void {\r\n\t\tthis._domEvents.detachAll();\r\n\t\tif(this._restoreOriginPosition){\r\n\t\t\tthis._restoreOriginPosition();\r\n\t\t}\r\n\r\n\t\tconst state = gantt.$services.getService(\"state\");\r\n\t\tstate.unregisterProvider(\"clickDrag\");\r\n\t}\r\n\r\n\tdestructor(): void {\r\n\t\tthis.detach();\r\n\t}\r\n\r\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\r\n\t\tconst viewPort = selectedRegion.getViewPort();\r\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\r\n\t\tconst { clientX, clientY } = event;\r\n\t\tconst result = {\r\n\t\t\tabsolute: {\r\n\t\t\t\tleft: clientX,\r\n\t\t\t\ttop: clientY,\r\n\t\t\t},\r\n\t\t\trelative: {\r\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\r\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn result;\r\n\t}\r\n}","import { EventsManager } from \"./eventsManager\";\r\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\r\ndeclare const gantt;\r\nif (!gantt.ext) {\r\n\tgantt.ext = {};\r\n}\r\n\r\nconst defaultConfig: ISelectedRegionConfig = {\r\n\tclassName: \"gantt_click_drag_rect\",\r\n\tuseRequestAnimationFrame: true,\r\n\tcallback: undefined,\r\n\tsingleRow: false\r\n};\r\n\r\nconst eventsManager = new EventsManager();\r\n\r\ngantt.ext.clickDrag = eventsManager;\r\n\r\ngantt.attachEvent(\"onGanttReady\", () => {\r\n\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\r\n\tif (gantt.config.click_drag) {\r\n\t\tconst clickDrag = gantt.config.click_drag;\r\n\t\tconfig.render = clickDrag.render || defaultConfig.render;\r\n\t\tconfig.className = clickDrag.className || defaultConfig.className;\r\n\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\r\n\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\r\n\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\r\n\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\r\n\r\n\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\r\n\t\tconst selectedRegion = new SelectedRegion(config);\r\n\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey);\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onDestroy\", () => {\r\n\teventsManager.destructor();\r\n});\r\n","var EventHost = function(){\r\n\tthis._connected = [];\r\n\tthis._silent_mode = false;\r\n};\r\n\r\nEventHost.prototype = {\r\n\t_silentStart: function() {\r\n\t\tthis._silent_mode = true;\r\n\t},\r\n\t_silentEnd: function() {\r\n\t\tthis._silent_mode = false;\r\n\t}\r\n};\r\n\r\nvar\tcreateEventStorage = function(obj) {\r\n\tvar dhx_catch = [];\r\n\tvar z = function(){\r\n\t\tvar res = true;\r\n\t\tfor (var i = 0; i < dhx_catch.length; i++){\r\n\t\t\tif (dhx_catch[i]){\r\n\t\t\t\tvar zr = dhx_catch[i].apply(obj, arguments);\r\n\t\t\t\tres=res&&zr;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\tz.addEvent=function(ev){\r\n\t\tif (typeof (ev) == \"function\")\r\n\t\t\treturn dhx_catch.push(ev)-1;\r\n\t\treturn false;\r\n\t};\r\n\tz.removeEvent=function(id){\r\n\t\tdhx_catch[id]=null;\r\n\t};\r\n\treturn z;\r\n};\r\n\r\nfunction makeEventable(obj){\r\n\r\n\tvar eventHost = new EventHost();\r\n\tobj.attachEvent=function(name, catcher, callObj){\r\n\t\tname='ev_'+name.toLowerCase();\r\n\t\tif (!eventHost[name])\r\n\t\t\teventHost[name] = createEventStorage(callObj||this);\r\n\r\n\t\treturn(name+':'+eventHost[name].addEvent(catcher)); //return ID (event name & event ID)\r\n\t};\r\n\tobj.attachAll = function(callback, callObj){\r\n\t\tthis.attachEvent('listen_all', callback, callObj);\r\n\t};\r\n\r\n\tobj.callEvent=function(name, arg0, callObj){\r\n\t\tif (eventHost._silent_mode) return true;\r\n\r\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\r\n\r\n\t\tif (eventHost['ev_listen_all']){\r\n\t\t\teventHost['ev_listen_all'].apply(callObj || this, [name].concat(arg0));\r\n\t\t}\r\n\r\n\t\tif (eventHost[handlerName])\r\n\t\t\treturn eventHost[handlerName].apply(callObj || this, arg0);\r\n\t\treturn true;\r\n\t};\r\n\tobj.checkEvent=function(name){\r\n\t\treturn (!!eventHost['ev_'+name.toLowerCase()]);\r\n\t};\r\n\tobj.detachEvent=function(id){\r\n\t\tif (id){\r\n\t\t\tvar list = id.split(':');//get EventName and ID\r\n\t\t\tvar eventName = list[0];\r\n\t\t\tvar eventId = list[1];\r\n\r\n\t\t\tif(eventHost[eventName]){\r\n\t\t\t\teventHost[eventName].removeEvent(eventId); //remove event\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tobj.detachAllEvents = function(){\r\n\t\tfor (var name in eventHost){\r\n\t\t\tif (name.indexOf(\"ev_\") === 0)\r\n\t\t\t\tdelete eventHost[name];\r\n\t\t}\r\n\t};\r\n\r\n}\r\n\r\nmodule.exports = makeEventable;"],"sourceRoot":""}